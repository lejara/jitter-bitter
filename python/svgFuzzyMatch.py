import sys
import json
from svgpathtools import parse_path
from shapely.geometry import LineString
import numpy as np

def path_to_linestring(d, n=200):
    p = parse_path(d)
    # compute segment lengths so sampling is proportional
    seg_lengths = [seg.length() for seg in p]
    total = sum(seg_lengths)
    pts = []
    for seg, L in zip(p, seg_lengths):
        count = max(2, int(n * (L/total)))      # at least 2 points per segment
        ts = np.linspace(0, 1, count)
        pts += [(seg.point(t).real, seg.point(t).imag) for t in ts]
    return LineString(pts)

def fuzzy_equal(d1, d2, tol=1e-3, samples=500):
    ls1 = path_to_linestring(d1, samples)
    ls2 = path_to_linestring(d2, samples)
    dist = ls1.hausdorff_distance(ls2)       # symmetric by default
    return (dist <= tol), dist


# — CLI glue —
def main():
    """
    Expects a single JSON object on stdin:
      { "d1": "...", "d2": "...", "tol": 0.001, "samples": 500 }
    Writes to stdout a JSON object:
      { "match": true, "distance": 0.00094 }
    """
    data = json.load(sys.stdin)
    match, dist = fuzzy_equal(
        data["d1"], data["d2"],
        tol=data.get("tol", 1e-3),
        samples=data.get("samples", 500)
    )
    print(json.dumps({ "match": match, "distance": dist }))
    sys.exit(0 if match else 1)

if __name__ == "__main__":
    main()


# Example:
# d1 = "M9.099999999999994 23.299999999999997C7.3 23.3 5.8 23 4.4 22.5C3.1 22 2.1 21.2 1.3 20.2C0.6 19.3 0.1 18.1 0 16.7L0 16.4L4.5 16.4L4.5 16.6C4.6 17.2 4.9 17.7 5.3 18.1C5.7 18.5 6.3 18.9 6.9 19.1C7.6 19.3 8.4 19.4 9.2 19.4C10.1 19.4 10.9 19.3 11.5 19.1C12.1 18.9 12.6 18.5 13 18.1C13.3 17.7 13.5 17.2 13.5 16.6L13.5 16.6C13.5 15.8 13.2 15.2 12.6 14.8C12 14.4 11 14 9.6 13.7L7.2 13.2C5 12.8 3.3 12 2.2 11C1.1 9.9 0.5 8.5 0.5 6.8L0.5 6.8C0.5 5.4 0.9 4.2 1.6 3.2C2.3 2.2 3.4 1.4 4.7 0.8C5.9 0.2 7.4 0 9.1 0C10.8 0 12.3 0.2 13.6 0.8C14.9 1.3 15.9 2.1 16.6 3.1C17.3 4.1 17.7 5.2 17.7 6.5L17.8 6.8L13.3 6.8L13.3 6.6C13.2 6 13 5.5 12.6 5.1C12.2 4.7 11.8 4.4 11.2 4.1C10.6 3.9 9.9 3.8 9.1 3.8C8.3 3.8 7.6 3.9 7 4.2C6.4 4.4 6 4.7 5.7 5.1C5.4 5.5 5.2 6 5.2 6.5L5.2 6.5C5.2 7.2 5.5 7.8 6.1 8.3C6.7 8.7 7.7 9 9 9.3L11.4 9.8C12.9 10.1 14.2 10.5 15.2 11.1C16.2 11.6 17 12.3 17.5 13.2C18 14 18.2 15 18.2 16.2L18.2 16.2C18.2 17.7 17.8 18.9 17.1 20C16.4 21 15.3 21.8 14 22.4C12.6 23 11 23.3 9.1 23.3ZM26.3 22.9L26.3 14.5L18.5 0.4L23.6 0.4L28.6 10L28.7 10L33.8 0.4L38.9 0.4L31 14.5L31 22.9L26.3 22.9ZM48 23.3C46.2 23.3 44.7 23 43.3 22.5C42 22 41 21.2 40.2 20.2C39.5 19.3 39 18.1 38.9 16.7L38.9 16.4L43.4 16.4L43.4 16.6C43.5 17.2 43.8 17.7 44.2 18.1C44.6 18.5 45.2 18.9 45.8 19.1C46.5 19.3 47.3 19.4 48.1 19.4C49 19.4 49.8 19.3 50.4 19.1C51 18.9 51.5 18.5 51.9 18.1C52.2 17.7 52.4 17.2 52.4 16.6L52.4 16.6C52.4 15.8 52.1 15.2 51.5 14.8C50.9 14.4 49.9 14 48.5 13.7L46.1 13.2C43.9 12.8 42.2 12 41.1 11C40 9.9 39.4 8.5 39.4 6.8L39.4 6.8C39.4 5.4 39.8 4.2 40.5 3.2C41.3 2.2 42.3 1.4 43.6 0.8C44.9 0.2 46.3 0 48 0C49.7 0 51.2 0.2 52.5 0.8C53.8 1.3 54.8 2.1 55.5 3.1C56.2 4.1 56.6 5.2 56.6 6.5L56.7 6.8L52.2 6.8L52.2 6.6C52.1 6 51.9 5.5 51.5 5.1C51.2 4.7 50.7 4.4 50.1 4.1C49.5 3.9 48.8 3.8 48 3.8C47.2 3.8 46.5 3.9 45.9 4.2C45.3 4.4 44.9 4.7 44.6 5.1C44.3 5.5 44.1 6 44.1 6.5L44.1 6.5C44.1 7.2 44.4 7.8 45 8.3C45.6 8.7 46.6 9 47.9 9.3L50.3 9.8C51.8 10.1 53.1 10.5 54.1 11.1C55.2 11.6 55.9 12.3 56.4 13.2C56.9 14 57.1 15 57.1 16.2L57.1 16.2C57.1 17.7 56.7 18.9 56 20C55.3 21 54.3 21.8 52.9 22.4C51.5 23 49.9 23.3 48 23.3ZM64.8 22.9L64.8 4.2L58.3 4.2L58.3 0.4L76 0.4L76 4.2L69.5 4.2L69.5 22.9L64.8 22.9ZM78.6 22.9L78.6 0.4L93.6 0.4L93.6 4.2L83.3 4.2L83.3 9.7L93 9.7L93 13.3L83.3 13.3L83.3 19L93.6 19L93.6 22.9L78.6 22.9ZM97 22.9L97 0.4L102.4 0.4L108.8 16.6L108.9 16.6L115.3 0.4L120.8 0.4L120.8 22.9L116.6 22.9L116.6 7.7L114.4 7.7L119.1 1L110.4 22.9L107.4 22.9L98.6 1L103.4 7.7L101.2 7.7L101.2 22.9L97 22.9ZM124.5 22.9L124.5 0.4L129.3 0.4L129.3 22.9L124.5 22.9ZM143 23.3C140.8 23.3 138.9 22.8 137.3 21.9C135.7 20.9 134.5 19.6 133.6 17.9C132.7 16.1 132.3 14 132.3 11.6L132.3 11.6C132.3 9.2 132.7 7.1 133.6 5.4C134.5 3.6 135.7 2.3 137.3 1.4C138.9 0.4 140.8 0 143 0C144.9 0 146.5 0.3 147.9 1C149.3 1.7 150.5 2.7 151.3 3.9C152.2 5.2 152.7 6.6 152.9 8.2L152.9 8.3L148.3 8.3L148.2 8.1C148 7.2 147.7 6.5 147.3 5.9C146.8 5.3 146.2 4.8 145.5 4.5C144.8 4.1 144 4 143 4C141.8 4 140.8 4.3 139.9 4.9C139 5.5 138.3 6.4 137.8 7.5C137.3 8.7 137.1 10 137.1 11.6L137.1 11.6C137.1 13.2 137.3 14.6 137.8 15.7C138.3 16.9 139 17.7 139.9 18.4C140.8 19 141.8 19.3 143 19.3C143.9 19.3 144.7 19.1 145.5 18.8C146.2 18.5 146.8 18 147.3 17.4C147.7 16.7 148.1 16 148.3 15.1L148.3 14.9L152.9 14.9L152.9 15.1C152.7 16.7 152.2 18.1 151.3 19.3C150.5 20.6 149.3 21.5 147.9 22.2C146.5 22.9 144.9 23.3 143 23.3ZM164.5 22.9L164.5 19.4L170.9 19.4C172.3 19.4 173.3 19.1 174 18.6C174.8 18 175.1 17.2 175.1 16.2L175.1 16.2C175.1 15.5 175 14.9 174.6 14.4C174.3 13.9 173.8 13.6 173.1 13.3C172.5 13.1 171.7 13 170.7 13L164.5 13L164.5 9.8L170.2 9.8C171.5 9.8 172.5 9.5 173.2 9C173.9 8.4 174.3 7.7 174.3 6.7L174.3 6.7C174.3 5.8 173.9 5.1 173.3 4.6C172.7 4.1 171.9 3.9 170.8 3.9L164.5 3.9L164.5 0.4L172 0.4C173.4 0.4 174.6 0.6 175.7 1C176.7 1.5 177.5 2.2 178 3C178.6 3.9 178.9 4.9 178.9 6L178.9 6C178.9 6.9 178.7 7.6 178.3 8.3C177.9 9 177.4 9.6 176.8 10.1C176.1 10.5 175.4 10.8 174.5 10.9L174.5 11C175.6 11.1 176.5 11.4 177.3 11.9C178.1 12.4 178.8 13 179.2 13.8C179.7 14.6 179.9 15.5 179.9 16.4L179.9 16.5C179.9 17.8 179.6 18.9 179 19.9C178.4 20.8 177.5 21.6 176.3 22.1C175.1 22.6 173.8 22.9 172.1 22.9L164.5 22.9ZM162.2 22.9L162.2 0.4L166.9 0.4L166.9 22.9L162.2 22.9ZM185 15.8L185 12.1L190.5 12.1C191.9 12.1 192.9 11.8 193.7 11.1C194.4 10.4 194.8 9.4 194.8 8.1L194.8 8.1C194.8 6.8 194.4 5.8 193.7 5.1C192.9 4.4 191.9 4.1 190.5 4.1L185 4.1L185 0.4L191.7 0.4C193.3 0.4 194.7 0.7 195.8 1.3C197 2 198 2.9 198.6 4C199.3 5.2 199.6 6.5 199.6 8.1L199.6 8.1C199.6 9.6 199.3 11 198.6 12.2C198 13.3 197 14.2 195.8 14.8C194.7 15.5 193.3 15.8 191.7 15.8L185 15.8ZM182.6 22.9L182.6 0.4L187.3 0.4L187.3 22.9L182.6 22.9Z"
# d2 = "M9.1 23.299999999999997C7.3 23.3 5.8 23 4.4 22.5C3.1 22 2.1 21.2 1.3 20.2C0.6 19.3 0.1 18.1 0 16.7L0 16.4L4.5 16.4L4.5 16.6C4.6 17.2 4.9 17.7 5.3 18.1C5.7 18.5 6.3 18.9 6.9 19.1C7.6 19.3 8.4 19.4 9.2 19.4C10.1 19.4 10.9 19.3 11.5 19.1C12.1 18.9 12.6 18.5 13 18.1C13.3 17.7 13.5 17.2 13.5 16.6L13.5 16.6C13.5 15.8 13.2 15.2 12.6 14.8C12 14.4 11 14 9.6 13.7L7.2 13.2C5 12.8 3.3 12 2.2 11C1.1 9.9 0.5 8.5 0.5 6.8L0.5 6.8C0.5 5.4 0.9 4.2 1.6 3.2C2.3 2.2 3.4 1.4 4.7 0.8C5.9 0.2 7.4 0 9.1 0C10.8 0 12.3 0.2 13.6 0.8C14.9 1.3 15.9 2.1 16.6 3.1C17.3 4.1 17.7 5.2 17.7 6.5L17.8 6.8L13.3 6.8L13.3 6.6C13.2 6 13 5.5 12.6 5.1C12.2 4.7 11.8 4.4 11.2 4.1C10.6 3.9 9.9 3.8 9.1 3.8C8.3 3.8 7.6 3.9 7 4.2C6.4 4.4 6 4.7 5.7 5.1C5.4 5.5 5.2 6 5.2 6.5L5.2 6.5C5.2 7.2 5.5 7.8 6.1 8.3C6.7 8.7 7.7 9 9 9.3L11.4 9.8C12.9 10.1 14.2 10.5 15.2 11.1C16.2 11.6 17 12.3 17.5 13.2C18 14 18.2 15 18.2 16.2L18.2 16.2C18.2 17.7 17.8 18.9 17.1 20C16.4 21 15.3 21.8 14 22.4C12.6 23 11 23.3 9.1 23.3ZM26.3 22.9L26.3 14.5L18.5 0.4L23.6 0.4L28.6 10L28.7 10L33.8 0.4L38.9 0.4L31 14.5L31 22.9L26.3 22.9ZM48 23.3C46.2 23.3 44.7 23 43.3 22.5C42 22 41 21.2 40.2 20.2C39.5 19.3 39 18.1 38.9 16.7L38.9 16.4L43.4 16.4L43.4 16.6C43.5 17.2 43.8 17.7 44.2 18.1C44.6 18.5 45.2 18.9 45.8 19.1C46.5 19.3 47.3 19.4 48.1 19.4C49 19.4 49.8 19.3 50.4 19.1C51 18.9 51.5 18.5 51.9 18.1C52.2 17.7 52.4 17.2 52.4 16.6L52.4 16.6C52.4 15.8 52.1 15.2 51.5 14.8C50.9 14.4 49.9 14 48.5 13.7L46.1 13.2C43.9 12.8 42.2 12 41.1 11C40 9.9 39.4 8.5 39.4 6.8L39.4 6.8C39.4 5.4 39.8 4.2 40.5 3.2C41.3 2.2 42.3 1.4 43.6 0.8C44.9 0.2 46.3 0 48 0C49.7 0 51.2 0.2 52.5 0.8C53.8 1.3 54.8 2.1 55.5 3.1C56.2 4.1 56.6 5.2 56.6 6.5L56.7 6.8L52.2 6.8L52.2 6.6C52.1 6 51.9 5.5 51.5 5.1C51.2 4.7 50.7 4.4 50.1 4.1C49.5 3.9 48.8 3.8 48 3.8C47.2 3.8 46.5 3.9 45.9 4.2C45.3 4.4 44.9 4.7 44.6 5.1C44.3 5.5 44.1 6 44.1 6.5L44.1 6.5C44.1 7.2 44.4 7.8 45 8.3C45.6 8.7 46.6 9 47.9 9.3L50.3 9.8C51.8 10.1 53.1 10.5 54.1 11.1C55.2 11.6 55.9 12.3 56.4 13.2C56.9 14 57.1 15 57.1 16.2L57.1 16.2C57.1 17.7 56.7 18.9 56 20C55.3 21 54.3 21.8 52.9 22.4C51.5 23 49.9 23.3 48 23.3ZM64.8 22.9L64.8 4.2L58.3 4.2L58.3 0.4L76 0.4L76 4.2L69.5 4.2L69.5 22.9L64.8 22.9ZM78.6 22.9L78.6 0.4L93.6 0.4L93.6 4.2L83.3 4.2L83.3 9.7L93 9.7L93 13.3L83.3 13.3L83.3 19L93.6 19L93.6 22.9L78.6 22.9ZM97 22.9L97 0.4L102.4 0.4L108.8 16.6L108.9 16.6L115.3 0.4L120.8 0.4L120.8 22.9L116.6 22.9L116.6 7.7L114.4 7.7L119.1 1L110.4 22.9L107.4 22.9L98.6 1L103.4 7.7L101.2 7.7L101.2 22.9L97 22.9ZM124.5 22.9L124.5 0.4L129.3 0.4L129.3 22.9L124.5 22.9ZM143 23.3C140.8 23.3 138.9 22.8 137.3 21.9C135.7 20.9 134.5 19.6 133.6 17.9C132.7 16.1 132.3 14 132.3 11.6L132.3 11.6C132.3 9.2 132.7 7.1 133.6 5.4C134.5 3.6 135.7 2.3 137.3 1.4C138.9 0.4 140.8 0 143 0C144.9 0 146.5 0.3 147.9 1C149.3 1.7 150.5 2.7 151.3 3.9C152.2 5.2 152.7 6.6 152.9 8.2L152.9 8.3L148.3 8.3L148.2 8.1C148 7.2 147.7 6.5 147.3 5.9C146.8 5.3 146.2 4.8 145.5 4.5C144.8 4.1 144 4 143 4C141.8 4 140.8 4.3 139.9 4.9C139 5.5 138.3 6.4 137.8 7.5C137.3 8.7 137.1 10 137.1 11.6L137.1 11.6C137.1 13.2 137.3 14.6 137.8 15.7C138.3 16.9 139 17.7 139.9 18.4C140.8 19 141.8 19.3 143 19.3C143.9 19.3 144.7 19.1 145.5 18.8C146.2 18.5 146.8 18 147.3 17.4C147.7 16.7 148.1 16 148.3 15.1L148.3 14.9L152.9 14.9L152.9 15.1C152.7 16.7 152.2 18.1 151.3 19.3C150.5 20.6 149.3 21.5 147.9 22.2C146.5 22.9 144.9 23.3 143 23.3ZM164.5 22.9L164.5 19.4L170.9 19.4C172.3 19.4 173.3 19.1 174 18.6C174.8 18 175.1 17.2 175.1 16.2L175.1 16.2C175.1 15.5 175 14.9 174.6 14.4C174.3 13.9 173.8 13.6 173.1 13.3C172.5 13.1 171.7 13 170.7 13L164.5 13L164.5 9.8L170.2 9.8C171.5 9.8 172.5 9.5 173.2 9C173.9 8.4 174.3 7.7 174.3 6.7L174.3 6.7C174.3 5.8 173.9 5.1 173.3 4.6C172.7 4.1 171.9 3.9 170.8 3.9L164.5 3.9L164.5 0.4L172 0.4C173.4 0.4 174.6 0.6 175.7 1C176.7 1.5 177.5 2.2 178 3C178.6 3.9 178.9 4.9 178.9 6L178.9 6C178.9 6.9 178.7 7.6 178.3 8.3C177.9 9 177.4 9.6 176.8 10.1C176.1 10.5 175.4 10.8 174.5 10.9L174.5 11C175.6 11.1 176.5 11.4 177.3 11.9C178.1 12.4 178.8 13 179.2 13.8C179.7 14.6 179.9 15.5 179.9 16.4L179.9 16.5C179.9 17.8 179.6 18.9 179 19.9C178.4 20.8 177.5 21.6 176.3 22.1C175.1 22.6 173.8 22.9 172.1 22.9L164.5 22.9ZM162.2 22.9L162.2 0.4L166.9 0.4L166.9 22.9L162.2 22.9ZM185 15.8L185 12.1L190.5 12.1C191.9 12.1 192.9 11.8 193.7 11.1C194.4 10.4 194.8 9.4 194.8 8.1L194.8 8.1C194.8 6.8 194.4 5.8 193.7 5.1C192.9 4.4 191.9 4.1 190.5 4.1L185 4.1L185 0.4L191.7 0.4C193.3 0.4 194.7 0.7 195.8 1.3C197 2 198 2.9 198.6 4C199.3 5.2 199.6 6.5 199.6 8.1L199.6 8.1C199.6 9.6 199.3 11 198.6 12.2C198 13.3 197 14.2 195.8 14.8C194.7 15.5 193.3 15.8 191.7 15.8L185 15.8ZM182.6 22.9L182.6 0.4L187.3 0.4L187.3 22.9L182.6 22.9Z"
# match, distance = fuzzy_equal(d1, d2, tol=1e-6)
# print(match, distance)